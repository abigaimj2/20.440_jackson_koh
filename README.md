# 20.440_jackson_koh

PROEJCT: Impact of HIV Infection and Antiretroviral Therapy on the Regulatory Epigenome through Methylome Modifications
(Abigail Jackson and Esther Koh, 2023)

OVERVIEW: The ultimate goal of this analysis is to investigate the positional enrichment of HIV-related methylation sites near regulatory landmarks to characterize the impact of HIV infection on genomic regulation. Provided code recapitulates the analysis performed in the report "Impact of HIV Infection and Antiretroviral Therapy on the Regulatory Epigenome through Methylome Modifications" by Abigail Jackson and Esther Koh, 2023. In brief, CpG sites identified as differentially methylated (DMPs) following HIV infection are analyzed for their positional enrichment relative to different regulatory landmarks including enhancers, promoters, DNAseI hypersensitive sites, and CTCF binding sites. DMPs are clustered and another positional enrichment analysis is performed on resultant clusters. This analysis is also recapitulated for HPV and SARS-CoV-2 for compraison. 

SYSTEM REQUIREMENTS: pandas1.5.2, seaborn0.11.2, matplotlib3.6.2, numpy 1.23.4, sklearn, scipy, Python Notebook editor of choice (code originated in VSCode)

DATA AVAILABILITY: All raw data necessary for analysis has been provided in /Data/Raw. Furthermore, preprocessed/intermediate data files have been provided in /Data. To execute all code, unzip the /Data folder locally in the location where the CODE folder lives. This will allow seamless execution of the code files. 
  - HIV DMPs: https://www.thelancet.com/journals/ebiom/article/PIIS2352-3964(22)00616-8/fulltext
  - HPV DMPs: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3142368/ 
  - SARS2 DMPs: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8767772/
  - CpG loci: https://support.illumina.com/downloads/humanmethylation27_product_support_files.html
  - enhancer/promoter loci: https://epilogos.altius.org/
  - DHS loci: https://www.encodeproject.org/experiments/ENCSR000ENC/
  - CTCFbs loci: https://insulatordb.uthsc.edu/

CODE AVAILABILITY: 
01_Data Preprocessing
Code to preprocess both the experimental data downloaded to identify differentially methylated positions as well as to preprocess all regulatory landmark data for use in downstream analyses. Raw input files have been provided within /Data/Raw, and all processed files have been provided within /Data. 

  expdata_preprocessing_v3.ipynb
  - Preprocessing of HIV data downloaded from Esteban-Cantos et al 2023
  - Inputs are located within /Data/Raw, outputs are located in /Data

  regulatory_preprocessing_v4.ipynb
  - Preprocessing of all regulatory landmark data downloaded from various sources (see Data documentation and report)
  - Inputs are located within /Data/Raw, outputs are located in /Data

02a_Positional Enrichment Analysis
Code to perform positional enrichment analysis of groups of CpG sites of interest relative to the genomic loci of particular regulatory landmark positions. Input files are located in /Data. 

  analysis_v6.ipynb
  - Positional enrichment analysis and figure generation for HIV, HPV, and SARS2 differentially methylated CpG sites. Analysis is performed both against random expectation and between clusters identified in 02b_Clustering+ML. 
  - Inputs are located within /Data. 

02b_Clustering + ML
Code to analyze various DMP datasets through hierarchical clustering and other clustering methods tested along with unsuccessful attempts at PCA and random forest model. 

  FINAL_fig2_HIV.ipynb
  - Hierarchical clustering of methylation levels of DMPs in the HIV datasets for both infection and treatment contexts. 
  - Visualizations of methylation landscape data as provided by the paper. 
  - Characterizing the methylation landscape of the two identified clusters from hierarchical clustering.

  FINAL_fig3_fig4a.ipynb
  - Unsuccessful attempts at clustering through hierarchical clustering and K-means clustering and unsuccessful dimensionality reduction by PCA on the distance matrix generated by calculating the distances to the closest RL in each RL class for each HIV DMP. Attempts at generating a random forest model also shown for this distance matrix. 
  - Frequencies of the closest RL type to each DMP and stratified by the identified DMP clusters.

  FINAL_fig7_HPV.ipynb
  - Hierarchical clustering of methylation levels of DMPs in the HPV datasets for both infection and treatment contexts. 
  - Visualizations of methylation landscape data as provided by the paper. 
  - Characterizing the methylation landscape of the two identified clusters from hierarchical clustering.

  FINAL_fig7_SARS.ipynb
  - Hierarchical clustering of methylation levels of DMPs in the SARS datasets for both infection and treatment contexts. 
  - Visualizations of methylation landscape data as provided by the paper. 
  - Characterizing the methylation landscape of the two identified clusters from hierarchical clustering.
